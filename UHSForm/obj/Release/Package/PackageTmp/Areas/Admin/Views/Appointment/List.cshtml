
@{
    ViewBag.Title = "Booking List";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutPage.cshtml";
}
<link href="~/Styles/custom.css" rel="stylesheet" type="text/css" />
<style>
    .pagination > li > a, .pagination > li > span {
        position: relative;
        float: left;
        padding: 6px 12px;
        line-height: 1.42857;
        text-decoration: none;
        color: #337ab7;
        background-color: #fff;
        border: 1px solid #ddd;
        margin-left: -1px;
    }
</style>
<div class="content d-flex flex-column flex-column-fluid" id="kt_content" ng-controller="BookingController">
    <!--begin::Post-->
    <div class="post d-flex flex-column-fluid" id="kt_post" ng-cloak>

        <!--begin::Container-->
        <div id="kt_content_container-fluid" class="container-fluid">

            <!--begin::Form-->
            <form name="SearchForm">
                <!--begin::Card-->
                <div class="card mb-7">
                    <!--begin::Card body-->
                    <div class="card-body">

                        <div class="row w-100" id="kt_searchassets">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Select Date</label>
                                <input class="form-control" type="date" name="Range" ng-model="txtDServiceDate" />
                            </div>

                            <div class="col-md-4" style="margin-top:20px;">
                                <!--begin::Button-->
                                <button type="submit" ng-click="Searchwithdate()" class="btn btn-primary">
                                    <span class="indicator-label" id="btnlistsearch">Search</span>
                                    <span class="indicator-progress" id="btnlistloader">
                                        Please wait...
                                        <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                                    </span>
                                </button>
                                <!--end::Button-->

                                <a class="btn btn-secondary" ng-click="resetfields()">Reset</a>
                            </div>

                        </div>
                        <div class="row"  ng-hide="filterdiv">
                            <div class="col-md-4 mb-5">

                                <label class="fs-6 fw-semibold mb-2">Customer Type</label>

                                <select name="ItemType" id="CustomerTypeID" aria-label="Select a Item Name" ng-model="ddlCustomerType" data-control="select2" data-placeholder="Select a Customer Type..." data-dropdown-parent="#kt_searchassets" class="form-select" ng-change="FilterData()">
                                    <option value="">Select a Type ...</option>

                                    <option value="New">New</option>
                                    <option value="Existing">Existing</option>
                                </select>
                            </div>

                            <div class="col-md-4 mb-5">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">Area</label>
                                <!--end::Label-->
                                <select name="ItemType" id="dltAreaID" aria-label="Select a Area" ng-model="ddlArea" data-control="select2" data-placeholder="Select a Area..." data-dropdown-parent="#kt_searchassets" class="form-select" ng-change="FilterData()">
                                    <option value="">Select a Area ...</option>
                                    <option value="{{area.ID}}" ng-repeat="area in AreaDropdown" ng-bind="area.Value"></option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-2">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">Select Residential</label>
                                <select name="ResidentialA" id="dltRestID" aria-label="Select a Property" ng-model="ddlResidential" ng-options="resd.ID as resd.Value for resd in ResidentialDropdown" ng-change="FilterData()" data-control="select2" data-placeholder="Select a Residential Type..." data-dropdown-parent="#kt_searchassets" class="form-select">
                                    <option value="">Select a  Type...</option>

                                </select>
                            </div>

                            
                            <div class="col-md-4 mb-2">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">Team</label>
                                <!--end::Label-->
                                <select name="Team" id="DdlTeamID" aria-label="Select a Team" ng-change="FilterData()" ng-model="ddlTeam" ng-options="team.ID as team.Value for team in TeamDropdown" data-control="select2" data-placeholder="Select a Team..." data-dropdown-parent="#kt_searchassets" class="form-select">
                                    <option value="">Select a Team...</option>


                                </select>
                            </div>
                            <div class="col-md-4 mb-2">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">Customer ID</label>
                                <!--end::Label-->
                                <select name="Customer" id="DdlCustomerID" aria-label="Select a Customer" ng-change="FilterData()" ng-model="ddlcustomerID" data-control="select2" data-placeholder="Select a Customer..." data-dropdown-parent="#kt_searchassets" class="form-select">
                                    <option value="">Select a Customer...</option>
                                    <option value="{{customer.Value}}" ng-repeat="customer in CustomerIDDropdown" ng-bind="'UHS_CT_'+customer.Value"></option>

                                </select>
                            </div>
                            <div class="col-md-4 mb-2">
                                <!--begin::Label-->
                                <label class="form-label fs-5 fw-semibold mb-3">Select Status:</label>
                                <!--end::Label-->
                                <!--begin::Input-->
                                <select class="form-select" id="FilterID" data-kt-select2="true" ng-change="FilterData()" data-placeholder="Select option" ng-model="ddlFilter">
                                    <option></option>
                                    <option value="All">All</option>
                                    <option value="Assigned">Assigned</option>
                                    <option value="unAssigned">unAssigned</option>

                                </select>
                                <!--end::Input-->
                            </div>
                            <div class="col-md-4 mb-2">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">Payment Status</label>
                                <!--end::Label-->
                                <select name="Status" id="PaymentID" aria-label="Select a Status" ng-change="FilterData()" ng-model="ddlPaymentStatus" data-control="select2" data-placeholder="Select a Status..." data-dropdown-parent="#kt_searchassets" class="form-select">
                                    <option value="">Select a Status...</option>
                                    <option value="0">
                                        New
                                    </option>
                                    <option value="2">
                                        Paid
                                    </option>
                                    <option value="1">
                                        Pending
                                    </option>
                                    <option value="3">
                                        Failed
                                    </option>
                                    <option value="4">
                                        Canceled
                                    </option>
                                </select>
                            </div>
                        </div>

                    </div>
                    <!--end::Card body-->
                </div>
                <!--end::Card-->
            </form>
            <!--end::Form-->
            <!--begin::Card-->
            <div class="card shadow-sm">
                <!--begin::Card header-->
                <div class="card-header border-0 pt-6" ng-show="filteredData.length!= 0">
                    <!--begin::Card title-->
                    <div class="card-title fw-medium">
                        <div class="d-flex align-items-center position-relative my-1">
                            <i class="ki-duotone ki-magnifier fs-3 position-absolute ms-5">
                                <span class="path1"></span>
                                <span class="path2"></span>
                            </i>
                            <input type="text"
                                   ng-model="searchTerm"
                                   data-kt-customer-table-filter="search"
                                   ng-change="updateSearch()"
                                   class="form-control w-250px ps-12 border border-primary rounded"
                                   placeholder="Search Customers">
                        </div>

                    </div>
                    <!--begin::Card title-->
                    <!--begin::Card toolbar-->
                    <div class="card-toolbar">

                        <!--begin::Toolbar-->
                        <div class="d-flex justify-content-end" data-kt-customer-table-toolbar="base">

                            <!--begin::Export-->
                            <button type="button" class="btn btn-light-primary me-3" ng-click="exportData('BookingList','xlsx',filteredData)">
                                <i class="ki-duotone ki-exit-up fs-2">
                                    <span class="path1"></span>
                                    <span class="path2"></span>
                                </i>Export
                            </button>
                            <!--end::Export-->

                        </div>
                        <!--end::Toolbar-->

                    </div>
                    <!--end::Card toolbar-->

                </div>
                <!--end::Card header-->
                <!--begin::Card body-->
                <div class="card-body pt-0">

                    <div class="table-responsive" id="tbl_bookinglist" style="display:none;">
                        <!--begin::Table-->
                        <table class="table  mt-4 mb-2" id="kt_customers_table" datatable="ng" dt-options="dtOptions">
                            <thead class="table-light">
                                <tr>
                                    <th>S.No</th>
                                    <th style="text-align:center;">Customer ID</th>
                                    <th style="text-align:center;">Customer Type</th>
                                    <th style="text-align:center;">Service Date</th>
                                    <th style="text-align:center;">Address</th>
                                    <th style="text-align:center;">Apt. Number</th>
                                    <th style="text-align:center;">Apt. Type</th>
                                    <th style="text-align:center;">Service Type</th>
                                    <th style="text-align:center;">Duration</th>

                                    <th style="text-align:center;">Service Team</th>
                                    
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="book in filteredData | filter:filterRecords" style="text-align:center;">
                                    <td ng-bind="$index+1"></td>
                                    <td>
                                        <a href="" ng-style="{'color': book.ServiceStatus != 'InActive' ? '' : 'red'}" ng-bind="book.CustomerID !=null ?'UHS_CT_'+book.CustomerID : 'N/A'" data-bs-toggle="modal" data-bs-target="#kt_modal_serviceDetails" ng-click="AllServicesPackage(book)"></a>
                                    </td>
                                    <td>
                                        <span class="badge py-3 px-4 fs-7" ng-class="{ 'badge-light-info':book.CustomerType == null,
        'badge-light-primary': book.CustomerType == 'New',
        'badge-light-success': book.CustomerType == 'Existing'}" ng-bind="book.CustomerType || 'N/A'"></span>

                                    </td>
                                    <td ng-if="book.ServiceStatus == 'InActive'" ng-bind="getFormattedDate(book.ServiceDate) | date:'fullDate'">
                                        <a href="" ></a>
                                    </td>
                                    <td ng-if="book.ServiceStatus == 'Active' || book.ServiceStatus == null"  ng-bind="getFormattedDate(book.ServiceDate) | date:'fullDate'">
                                        
                                    </td>
                                    <td ng-bind="book.Address">
                                    </td>
                                    <td ng-bind="book.ApartmentName || 'N/A'"></td>
                                    <td  ng-bind="book.PropertyResidencyType || 'N/A'"></td>
                                    <td  ng-bind="book.ServiceType"></td>
                                    @*<td style="text-align:center;" ng-bind="getFormattedDate(book.Date) | date:'fullDate'"></td>*@
                                    <td  ng-bind="formatTime(book.Duration,book.Measurement)"></td>

                                    <td  ng-bind="(!!book.TeamName ? book.TeamName : (!!book.staffName ? book.staffName + (!!book.TeamName && !!book.staffName ? ' and ' : '') : 'N/A')) + ((!book.TeamName && !book.staffName) ? '' : '')"></td>

                                    @*<td>
                                        <span class="badge py-3 px-4 fs-7"
                                              ng-class="{
         'badge-light-info': book.PaymentStatus && book.PaymentStatus.PaymentStatus == null,
        'badge-light-primary': book.PaymentStatus && book.PaymentStatus.PaymentStatus == 0,
        'badge-light-success': book.PaymentStatus && book.PaymentStatus.PaymentStatus == 2,
        'badge-light-warning': book.PaymentStatus && book.PaymentStatus.PaymentStatus == 1,
        'badge-light-danger': book.PaymentStatus && (book.PaymentStatus.PaymentStatus == 3 || book.PaymentStatus.PaymentStatus == 4),
        'badge-light-yellow': !book.PaymentStatus || book.PaymentStatus.PaymentStatus == null
      }"
                                              ng-bind="getPaymentStatus(book.PaymentStatus)">
                                        </span>

                                    </td>*@



                                    <td style="text-align:center;">
                                        <a class="btn btn-light btn-active-light-primary btn-flex btn-center btn-sm" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            Action <i class="ki-duotone ki-down fs-5 ms-1"></i>
                                        </a>
                                        <div ng-if="book.ServiceStatus != null && book.ServiceStatus != 'InActive'" class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">

                                            <a class="dropdown-item" ng-if="(book.TeamName == null || book.TeamName == 'N/A') && book.ServiceStatus != null && book.ServiceStatus != 'InActive'"
 href="#" data-bs-toggle="modal" ng-click="AssignDespModal(book)">Assign</a>



                                            <a class="dropdown-item" ng-if="book.ServiceStatus != 'InActive'" href="#" data-bs-toggle="modal" data-bs-target="#sespendservice" ng-click="SespendServiceModal(book)">Suspend Service</a>
                                            <a class="dropdown-item" ng-if="book.ServiceStatus != 'InActive'" href="#" data-bs-toggle="modal" data-bs-target="#messageModal" ng-click="openMessageModal(book)">Send Notification</a>

                                            @*<a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#assignReqModal" ng-click="AssignModal(book)">Assign</a>*@




                                        </div>
                                    </td>

                                </tr>


                            </tbody>
                        </table>
                        <!--end::Table-->
                    </div>
                    <div id="tbl_dummybooking">
                        <table class="table">
                            <thead>
                                <tr class="text-start  fw-bold fs-7 text-uppercase gs-0">
                                    <th class="min-w-50px">S.No</th>

                                    <th class="min-w-100px">Area</th>
                                    <th class="min-w-100px">Property Name</th>
                                    <th class="min-w-100px">A. Number</th>
                                    <th class="min-w-100px">A. Type</th>

                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="10" style="color:blue;" id="spanLoader"><span><b>Loading...</b></span></td>
                                    <td colspan="10" style="color:red;display:none;" id="spanEmptyRecords"><span>No records found!</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!--end::Card body-->
            </div>
            <!--end::Card-->

            <div class="modal fade" id="assignReqModal1" tabindex="-1" aria-hidden="true">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-dialog-centered mw-850px">

                    <!--begin::Modal content-->
                    <div class="modal-content">
                        <form class="form" name="AddAssignTeamForm" novalidate>
                            <!--begin::Modal header-->
                            <div class="modal-header" id="kt_modal_add_customer_header">
                                <!--begin::Modal title-->
                                <h2 class="fw-bold">Assign Team</h2>
                                <!--end::Modal title-->
                                <!--begin::Close-->
                                <div data-bs-dismiss="modal" ng-click="initFormAssign()" class="btn btn-icon btn-sm btn-active-icon-primary">
                                    <i class="ki-outline ki-cross fs-1"></i>
                                </div>
                                <!--end::Close-->
                            </div>
                            <!--end::Modal header-->
                            <!--begin::Modal body-->
                            <div class="modal-body py-10 px-lg-17">

                                <div class="row">
                                    <div class="col-md-6 mb-6">
                                        <label class="required fs-6 fw-semibold mb-2">Select Team</label>
                                        <select id="TeamAssign" name="Team" ng-model="txtTeam" aria-label="Select a Team" data-control="select2" data-placeholder="Select a Team..." data-dropdown-parent="#assignReqModal1" class="form-select">
                                            <option value="">Select Team...</option>
                                            <option value="{{team.ID}}" ng-repeat="team in DSTeamDropdown">
                                                {{team.Value}}
                                            </option>

                                        </select>
                                        <span ng-if="AddAssignTeamForm.$submitted && AddAssignTeamForm.Team.$invalid" style="color:red">field is required</span>

                                    </div>
                                </div>


                            </div>
                            <!--end::Modal body-->
                            <!--begin::Modal footer-->
                            <div class="modal-footer flex-center">
                                <!--begin::Button-->
                                <button type="reset" ng-click="initFormAssign()" data-bs-dismiss="modal" class="btn btn-light me-3">Discard</button>
                                <!--end::Button-->
                                <!--begin::Button-->
                                <button type="submit" ng-click="AssignTeamD(AddAssignTeamForm.$valid)" class="btn btn-primary">
                                    <span class="indicator-label" id="btnAssignTsave">Submit</span>
                                    <span class="indicator-progress" id="btnAsTeamloader">
                                        Please wait...
                                        <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                                    </span>
                                </button>
                                <!--end::Button-->
                            </div>
                            <!--end::Modal footer-->
                        </form>
                    </div>
                </div>
            </div>




            <div class="modal fade" id="sespendservice" tabindex="-1" aria-hidden="true">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-dialog-centered mw-650px">

                    <!--begin::Modal content-->
                    <div class="modal-content">
                        <form class="form" name="SuspendServiceForm" novalidate autocomplete="off">
                            <!--begin::Modal header-->
                            <div class="modal-header" id="kt_modal_add_customer_header">
                                <!--begin::Modal title-->
                                <h2 class="fw-bold">Suspend the Service  {{CustomerName}}</h2>
                                <!--end::Modal title-->
                                <!--begin::Close-->
                                <div data-bs-dismiss="modal" ng-click="initFormSuspendAssign()" class="btn btn-icon btn-sm btn-active-icon-primary">
                                    <i class="ki-outline ki-cross fs-1"></i>
                                </div>
                                <!--end::Close-->
                            </div>
                            <!--end::Modal header-->
                            <!--begin::Modal body-->
                            <div class="modal-body py-10 px-lg-17">

                                <h5 class="card-title mb-10">Kindly Enter your login Credentials:</h5>
                                <!--begin::Input group-->
                                <div class="fv-row mb-4">
                                    <!--begin::Label-->
                                    <label class="required fs-6 fw-semibold mb-2">Email</label>
                                    <!--end::Label-->
                                    <!--begin::Input-->
                                    <input type="text" id="usernameS" class="form-control" ng-model="txtUsernameS" placeholder="" autocomplete="user-name" name="SespendUsername" required />
                                    <!--end::Input-->
                                    <span ng-if="SuspendServiceForm.$submitted && SuspendServiceForm.SespendUsername.$invalid" style="color:red">field is required</span>
                                </div>
                                <!--end::Input group-->
                                <!--begin::Input group-->
                                <div class="fv-row mb-4">
                                    <!--begin::Label-->
                                    <label class="required fs-6 fw-semibold mb-2">Password</label>
                                    <!--begin::Password-->
                                    <input ng-model="txtPasswordS" type="password" id="PasswordS" name="Password" required autocomplete="new-password" class="form-control" />
                                    <!--end::Password-->
                                    <span ng-if="SuspendServiceForm.$submitted && SuspendServiceForm.Password.$invalid" style="color:red">field is required</span>

                                </div>
                                <!--end::Input group-->
                                <!--begin::Input group-->
                                <div class="fv-row mb-4">
                                    <!--begin::Label-->
                                    <label class="fs-6 fw-semibold mb-2">Remarks</label>
                                    <!--end::Label-->
                                    <!--begin::Input-->
                                    <input type="text" class="form-control" ng-model="txtremarks" placeholder="" name="remarks" />
                                    <!--end::Input-->

                                </div>
                                <!--end::Input group-->

                            </div>
                            <!--end::Modal body-->
                            <!--begin::Modal footer-->
                            <div class="modal-footer flex-center">
                                <!--begin::Button-->
                                <button type="reset" ng-click="initFormSuspendAssign()" data-bs-dismiss="modal" class="btn btn-light me-3">Discard</button>
                                <!--end::Button-->
                                <!--begin::Button-->
                                <button type="submit" ng-click="SupendServSave(SuspendServiceForm.$valid)" class="btn btn-primary">
                                    <span class="indicator-label" id="btnsuspendTsave">Submit</span>
                                    <span class="indicator-progress" id="btnAssuspendloader">
                                        Please wait...
                                        <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                                    </span>
                                </button>
                                <!--end::Button-->
                            </div>
                            <!--end::Modal footer-->
                        </form>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="assignReqModal" tabindex="-1" aria-hidden="true">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-dialog-centered mw-850px">

                    <!--begin::Modal content-->
                    <div class="modal-content">
                        <form class="form" name="AddAssignForm" novalidate>
                            <!--begin::Modal header-->
                            <div class="modal-header" id="kt_modal_add_customer_header">
                                <!--begin::Modal title-->
                                <h2 class="fw-bold">Assign Cleaner/Team</h2>
                                <!--end::Modal title-->
                                <!--begin::Close-->
                                <div data-bs-dismiss="modal" ng-click="initForm()" class="btn btn-icon btn-sm btn-active-icon-primary">
                                    <i class="ki-outline ki-cross fs-1"></i>
                                </div>
                                <!--end::Close-->
                            </div>
                            <!--end::Modal header-->
                            <!--begin::Modal body-->
                            <div class="modal-body py-10 px-lg-17">

                                <div class="row">
                                    <div class="col-md-6 mb-6">
                                        <label class="required fs-6 fw-semibold mb-2">Select Type</label>
                                        <select name="STeamType" id="ddlType" ng-change="Typebased()" ng-model="txtType" aria-label="Select a Type" data-control="select2" data-placeholder="Select a Type..." data-dropdown-parent="#assignReqModal" class="form-select" required>
                                            <option value="">Select Type...</option>
                                            <option value="Staff">Cleaner</option>
                                            <option value="Team">Team</option>
                                        </select>
                                        <span ng-if="AddAssignForm.$submitted && AddAssignForm.STeamType.$invalid" style="color:red">field is required</span>
                                    </div>
                                    <div class="col-md-6 mb-6" ng-hide="TeamDiv">
                                        <label class="required fs-6 fw-semibold mb-2">Select Team</label>
                                        <select name="Team" ng-model="txtTeam" aria-label="Select a Team" data-control="select2" data-placeholder="Select a Team..." data-dropdown-parent="#assignReqModal" class="form-select">
                                            <option value="">Select Team...</option>
                                            <option value="{{team.ID}}" ng-repeat="team in TeamDropdown">
                                                {{team.Value}}
                                            </option>

                                        </select>
                                        <span style="color:red" ng-bind="msgVTeam"></span>
                                    </div>
                                    <div class="col-md-6 mb-6" ng-hide="StaffDiv">
                                        <!--begin::Label-->
                                        <label class="required fs-6 fw-semibold mb-2">Select Cleaner</label>
                                        <!--end::Label-->
                                        <select name="Staff" aria-label="Select a Cleaner" ng-model="ddlstaff" data-control="select2" data-placeholder="Select a Cleaner..." data-dropdown-parent="#assignReqModal" class="form-select">
                                            <option value="">Select a  Cleaner...</option>

                                            <option value="{{user.ID}}" ng-repeat="user in GetUserDropdown">
                                                {{user.Value}}
                                            </option>


                                        </select>
                                        <span style="color:red" ng-bind="msgVStaff"></span>
                                    </div>
                                </div>


                            </div>
                            <!--end::Modal body-->
                            <!--begin::Modal footer-->
                            <div class="modal-footer flex-center">
                                <!--begin::Button-->
                                <button type="reset" ng-click="initForm()" data-bs-dismiss="modal" class="btn btn-light me-3">Discard</button>
                                <!--end::Button-->
                                <!--begin::Button-->
                                <button type="submit" ng-click="AssignRequest(AddAssignForm.$valid)" class="btn btn-primary">
                                    <span class="indicator-label" id="btnAssave">Submit</span>
                                    <span class="indicator-progress" id="btnAsloader">
                                        Please wait...
                                        <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                                    </span>
                                </button>
                                <!--end::Button-->
                            </div>
                            <!--end::Modal footer-->
                        </form>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="kt_modal_serviceslist" tabindex="-1" aria-hidden="true">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-dialog-centered mw-850px">
                    <!--begin::Modal content-->
                    <div class="modal-content">
                        <!--begin::Modal header-->
                        <div class="modal-header" id="kt_modal_add_customer_header">
                            <!--begin::Modal title-->
                            <h2 class="fw-bold">Services List</h2>
                            <!--end::Modal title-->
                            <!--begin::Close-->
                            <div data-bs-dismiss="modal" class="btn btn-icon btn-sm btn-active-icon-primary">
                                <i class="ki-outline ki-cross fs-1"></i>
                            </div>
                            <!--end::Close-->
                        </div>
                        <!--end::Modal header-->
                        <!--begin::Modal body-->
                        <div class="modal-body py-10 px-lg-17">
                            <div class="card">

                                <div class="card-body">

                                    <div class="table-responsive border-bottom mb-5" id="tbl_servicesList" style="display:none;">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th class="min-w-175px">Service Category</th>
                                                    <th class="min-w-175px">Sub Category</th>
                                                    <th class="min-w-70px">Quantity</th>

                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="" ng-repeat="servs in ServiceList">
                                                    <td ng-bind="servs.ServiceCategoryName"></td>
                                                    <td ng-bind="servs.ServiceSubCategoryName"></td>
                                                    <td ng-bind="servs.Quantity"></td>

                                                </tr>

                                            </tbody>
                                        </table>
                                    </div>


                                    <div class="table-responsive border-bottom mb-5" id="tbl_dummyservices">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th class="min-w-175px">Service Category</th>
                                                    <th class="min-w-175px">Sub Category</th>
                                                    <th class="min-w-70px">Quantity</th>

                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td colspan="8" style="color:blue;" id="spanservLoader"><span><b>Loading...</b></span></td>
                                                    <td colspan="8" style="color:red;display:none;" id="spanEmptyservRecords"><span>No records found!</span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>


                            <!--begin::Scroll-->
                            <!--end::Input group-->


                        </div>
                        <!--end::Modal body-->

                    </div>
                </div>
            </div>

            <div class="modal fade" id="kt_modal_packagelist" tabindex="-1" aria-hidden="true">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-fullscreen">
                    <!--begin::Modal content-->
                    <div class="modal-content">
                        <!--begin::Modal header-->
                        <div class="modal-header" id="kt_modal_add_customer_header">
                            <!--begin::Modal title-->
                            <h2 class="fw-bold">Packages List</h2>
                            <!--end::Modal title-->
                            <!--begin::Close-->
                            <div data-bs-dismiss="modal" class="btn btn-icon btn-sm btn-active-icon-primary">
                                <i class="ki-outline ki-cross fs-1"></i>
                            </div>
                            <!--end::Close-->
                        </div>
                        <!--end::Modal header-->
                        <!--begin::Modal body-->
                        <div class="modal-body py-10 px-lg-17">
                            <div class="card">

                                <div class="card-body">

                                    <div class="table-responsive border-bottom mb-5" id="tbl_packageList" style="display:none;">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th class="min-w-175px">Package Name</th>
                                                    <th class="min-w-100px">Date</th>
                                                    <th class="min-w-100px">Duration</th>

                                                    <th class="min-w-100px">Price</th>

                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="" ng-repeat="package in PackagesList">
                                                    <td ng-bind="package.PackageName"></td>
                                                    <td ng-bind="getFormattedDate(package.Date) | date:'fullDate'"></td>
                                                    <td ng-bind="package.Duration + ' ' + package.Measurement "></td>
                                                    <td ng-bind="package.Price"></td>

                                                </tr>

                                            </tbody>
                                        </table>
                                    </div>


                                    <div class="table-responsive border-bottom mb-5" id="tbl_dummypackage">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th class="min-w-175px">Package Name</th>
                                                    <th class="min-w-100px">Date</th>
                                                    <th class="min-w-100px">Duration</th>

                                                    <th class="min-w-100px">Price</th>

                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td colspan="8" style="color:blue;" id="spanpackLoader"><span><b>Loading...</b></span></td>
                                                    <td colspan="8" style="color:red;display:none;" id="spanEmptypackRecords"><span>No records found!</span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>


                            <!--begin::Scroll-->
                            <!--end::Input group-->


                        </div>
                        <!--end::Modal body-->

                    </div>
                </div>
            </div>
            <div class="modal fade" id="kt_modal_serviceDetails" tabindex="-1" aria-hidden="true">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-fullscreen">
                    <!--begin::Modal content-->
                    <div class="modal-content">
                        <!--begin::Modal header-->
                        <div class="modal-header" id="kt_modal_add_customer_header">
                            <!--begin::Modal title-->
                            <h2 class="fw-bold" ng-bind="Name + ' Service Details'"></h2>
                            <!--end::Modal title-->
                            <!--begin::Close-->
                            <div data-bs-dismiss="modal" class="btn btn-icon btn-sm btn-active-icon-primary">
                                <i class="ki-outline ki-cross fs-1"></i>
                            </div>
                            <!--end::Close-->
                        </div>
                        <!--end::Modal header-->
                        <!--begin::Modal body-->
                        <div class="modal-body py-10 px-lg-17">
                            <div class="card shadow-sm">

                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Customer ID:</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].CustomerID !=null ?'UHS_CT_'+GetDetails[0].CustomerID : 'N/A'"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Customer Type:</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].CustomerType">
                                                <span class="badge py-3 px-4 fs-7" ng-class="{ 'badge-light-info':GetDetails[0].CustomerType == null,
'badge-light-primary': GetDetails[0].CustomerType == 'New',
'badge-light-success': GetDetails[0].CustomerType == 'Existing'}" ng-bind="GetDetails[0].CustomerType || 'N/A'"></span>
                                            </label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Customer Name:</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].Name"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Contact Number</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].Mobile || 'N/A'"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">WhatsApp Number</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].WhatsAppNo!='974undefined'? GetDetails[0].WhatsAppNo : 'N/A'"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Alternate Number</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].AlternativeNo || 'N/A'"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Email ID</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].Email || 'N/A'"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Category:</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].MainCategory"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Sub Category</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].SubCategory || 'N/A'"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Residential Type</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].PropertyResidencyType || 'N/A'"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Booking Date</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="getFormattedDate(GetDetails[0].CreatedOn)"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">End Date</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="getFormattedDate(GetDetails[0].EndDate) || 'N/A'"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">No Of Month</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].NoOfMonths || 'N/A'"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Special Instruction</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].Remarks || 'N/A'"></label>
                                        </div>


                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Availability in the Apartment:</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].
GetCustomerAvailability != null ? (GetDetails[0].
GetCustomerAvailability.Availability == true ? 'Yes' : 'No') : ''"></label>
                                        </div>
                                        <div class="col-md-4 mb-4" ng-if="GetDetails[0].
GetCustomerAvailability.Availability == false">
                                            <label for="phone" class="control-label">Key Collection:</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].
GetCustomerAvailability != null ? (GetDetails[0].
GetCustomerAvailability.KeyCollection == true ? 'Yes' : 'No') : ''"></label>
                                        </div>
                                        <div class="col-md-4 mb-4" ng-if="GetDetails[0].
GetCustomerAvailability.Availability == false">
                                            <label for="phone" class="control-label">Access Details</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].
GetCustomerAvailability.AccessProperty || 'N/A'"></label>
                                        </div>
                                        <div class="col-md-4 mb-4" ng-if="GetDetails[0].
GetCustomerAvailability.Availability == false">
                                            <label for="phone" class="control-label">Date:</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].
GetCustomerAvailability.ReceptionDate==null ? 'N/A' : GetDetails[0].AvailabilityList.ReceptionDate.replace('/Date(','').replace(')/','') | date"></label>
                                        </div>

                                        <div class="col-md-4 mb-4" ng-if="AllServicesDetails.length != 0">
                                            <label for="phone" class="control-label" style="font-size: 1.2rem; color: #6c757d;">
                                                <i class="fas fa-tag"></i> Total Price
                                            </label>
                                            <div class="p-3 mt-2 rounded shadow-sm"
                                                 style="background-color: #f8f9fa; font-weight: bold; font-size: 1.5rem; color: #007bff; text-align: center;">
                                                {{ getTotalPrice() | currencyFormat }}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row" ng-if="GetDetails[0].IsCarWash != false && GetDetails[0].IsCarWash != null">

                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Car Wash Timing</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].CarWashTimes"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Car Type</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].CarType"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Car Service Type</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].CarServiceType"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Parking Level</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].CustomCarDetails.ParkingLevel"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Parking Number</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].CustomCarDetails.ParkingNumber"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Vehicle Brand</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].CustomCarDetails.VehicleBrand"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Vehicle Color</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].CustomCarDetails.VehicleColor"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Vehicle Number</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].CustomCarDetails.VehicleNumber"></label>
                                        </div>
                                    </div>
                                    <div class="row" ng-if="GetDetails.OtherLocation != null">
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Tower Name:</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].OtherLocation.TowerName"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Building Number</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].OtherLocation.BuildingName"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Street Number</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].OtherLocation.StreetNumber"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Zone Number</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].OtherLocation.ZoneNumber"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Location</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails[0].OtherLocation.Loacation"></label>
                                        </div>
                                        <div class="col-md-4 mb-4">
                                            <label for="phone" class="control-label">Location URL</label><br />
                                            <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;">
                                                <a href="{{GetDetails[0].OtherLocation.LocationLink}}" ng-bind="GetDetails[0].OtherLocation.LocationLink || 'N/A'"></a>
                                            </label>
                                        </div>
                                    </div>

                                    <div class="row" ng-if="GetDetails[0].Files != null">
                                        <div class="col-sm-12">

                                            <a href="{{image.Value}}" class="mr-2" ng-repeat="image in GetDetails[0].Files" data-toggle="lightbox" data-gallery="img-gallery" data-title="Incident Images" data-max-width="600">
                                                <img class="img-responsive" ng-src="{{image.Value}}" style="width:200px;height:200px;" />
                                            </a>
                                        </div>
                                    </div>
                                    <div class="table-responsive" id="tbl_bookingRelist" style="display:none;">
                                        <!--begin::Table-->
                                        <table class="table table-bordered gs-7 gy-7 gx-7" id="kt_customers_all" datatable="ng" dt-options="vm.dtOptions">
                                            <thead>
                                                <tr>

                                                    <th class="w-10px pe-2" ng-if="CustomerDetls.teamID !=null">

                                                    </th>
                                                    <th style="text-align: center;" class="min-w-100px">Frequency</th>
                                                    <th style="text-align: center;" class="min-w-50px">Task No</th>
                                                    <th style="text-align: center;" class="min-w-100px">Date</th>
                                                    <th style="text-align: center;" class="min-w-100px">Team</th>
                                                    <th style="text-align: center;" class="min-w-75px">Start Time</th>
                                                    <th style="text-align: center;" class="min-w-75px">End Time</th>
                                                    <th style="text-align: center;" class="min-w-30px">Duration</th>

                                                    <th style="text-align: center;" class="min-w-50px">Price</th>
                                                    <th style="text-align: center;" class="min-w-50px">Payment Status</th>

                                                    <th style="text-align: center;" class="min-w-50px">Status</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="package in AllServicesDetails | filter: searchbook" style="text-align:center;">

                                                    <td ng-if="CustomerDetls.teamID !=null">
                                                        <div ng-if="package.WorkingStatus != 'Closed'" class="form-check form-check-sm form-check-custom form-check-solid">
                                                            <!-- Bind the checkbox to the 'selected' property -->
                                                            <input class="form-check-input" type="checkbox"
                                                                   ng-model="package.selected"
                                                                   ng-click="selectPackage(package)" />
                                                        </div>
                                                    </td>


                                                    <td ng-bind="package.PackageName"></td>
                                                    <td ng-bind="package.TaskNo !=null ?'UHS_TAS_'+package.TaskNo : 'N/A'"></td>

                                                    <td ng-bind="getFormattedDate(package.ServiceDate) | date:'fullDate'"></td>
                                                    <td ng-bind="package.TeamName"></td>
                                                    <td ng-bind="package.StartTime"></td>
                                                    <td ng-bind="package.EndTime"></td>
                                                    <td ng-bind="formatTime(package.Duration,package.TimeMeasurement)"></td>
                                                    <td ng-bind="package.Price + ' QR'"></td>
                                                    <td>
                                                        <span class="badge py-3 px-4 fs-7"
                                                              ng-class="{
         'badge-light-info': package.PaymentStatus && package.PaymentStatus == null,
        'badge-light-primary': package.PaymentStatus && package.PaymentStatus == 0,
        'badge-light-success': package.PaymentStatus && package.PaymentStatus == 2,
        'badge-light-warning': package.PaymentStatus && package.PaymentStatus == 1,
        'badge-light-danger': package.PaymentStatus && (package.PaymentStatus == 3 || package.PaymentStatus == 4),
        'badge-light-yellow': !package.PaymentStatus || package.PaymentStatus == null
      }"
                                                              ng-bind="getPaymentStatuswithoutObject(package.PaymentStatus)">
                                                        </span>

                                                    </td>
                                                    <td>
                                                        <span class="badge py-3 px-4 fs-7" ng-class="{ 'badge-light-info':package.WorkingStatus== 'Open',
        'badge-light-primary': package.WorkingStatus
 == 'Pending',
        'badge-light-success': package.WorkingStatus
 == 'Closed'}" ng-bind="package.WorkingStatus
=='Open'?'Open':package.WorkingStatus
=='Pending'?'Pending':package.WorkingStatus

=='Closed'?'Closed':'N/A'"></span>
                                                    </td>
                                                    <td style="text-align:center;">
                                                        <a class="btn btn-light btn-active-light-primary btn-flex btn-center btn-sm" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                            Action <i class="ki-duotone ki-down fs-5 ms-1"></i>
                                                        </a>
                                                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">

                                                            <a class="dropdown-item" ng-if="package.WorkingStatus == 'Pending'" href="#" ng-click="AssignreaspModal(package)">Team reassign</a>




                                                        </div>
                                                    </td>

                                                </tr>


                                            </tbody>
                                        </table>
                                        <!--end::Table-->

                                    </div>
                                    <div id="tbl_dummyRbooking">
                                        <table class="table">
                                            <thead>
                                                <tr class="text-start  fw-bold fs-7 text-uppercase gs-0">
                                                    <th class="min-w-175px">Package Name</th>
                                                    <th>Task No</th>
                                                    <th class="min-w-100px">Date</th>
                                                    <th class="min-w-50px">Start Time</th>
                                                    <th class="min-w-50px">End Time</th>
                                                    <th class="min-w-100px">Duration</th>

                                                    <th class="min-w-100px">Price</th>
                                                    <th>Payment Status</th>
                                                    <th>Status</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td colspan="10" style="color:blue;" id="spanRLoader"><span><b>Loading...</b></span></td>
                                                    <td colspan="10" style="color:red;display:none;" id="spanEmptyRRecords"><span>No records found!</span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>


                            <!--begin::Scroll-->
                            <!--end::Input group-->


                        </div>
                        <!--end::Modal body-->
                        <!--begin::Modal footer-->
                        <div class="modal-footer flex-center">
                            <!--begin::Button-->
                            <button type="reset" data-bs-dismiss="modal" class="btn btn-light me-3">Discard</button>
                            <!--end::Button-->
                            <!--begin::Button-->
                            <button type="submit" ng-if="CustomerDetls.teamID !=null" ng-disabled="!selectedPackage" class="btn btn-primary">
                                <span class="indicator-label" id="reschedulegetdate" ng-click="RescheduleDateModal()">Reschedule</span>
                                <span class="indicator-progress" id="rescheduleloader">
                                    Please wait...
                                    <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                                </span>
                            </button>
                            <!--end::Button-->
                        </div>
                        <!--end::Modal footer-->
                    </div>
                </div>
            </div>
            <div class="modal fade" id="kt_modal_remilist" tabindex="-1" aria-hidden="true">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-dialog-centered mw-850px">
                    <!--begin::Modal content-->
                    <div class="modal-content">
                        <!--begin::Modal header-->
                        <div class="modal-header" id="kt_modal_add_customer_header">
                            <!--begin::Modal title-->
                            <h2 class="fw-bold">Customer Details</h2>
                            <!--end::Modal title-->
                            <!--begin::Close-->
                            <div data-bs-dismiss="modal" class="btn btn-icon btn-sm btn-active-icon-primary">
                                <i class="ki-outline ki-cross fs-1"></i>
                            </div>
                            <!--end::Close-->
                        </div>
                        <!--end::Modal header-->
                        <!--begin::Modal body-->
                        <div class="modal-body py-10 px-lg-17">

                            <div class="row">
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Customer Name:</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.Name"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Contact Number</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.Mobile || 'N/A'"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">WhatsApp Number</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.WhatsAppNo || 'N/A'"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Alternate Number</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.AlternativeNo || 'N/A'"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Email ID</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.Email || 'N/A'"></label>
                                </div>

                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Start Date</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="getFormattedDate(GetDetails.Date)"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">End Date</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="getFormattedDate(GetDetails.EndDate) || 'N/A'"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">No Of Month</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.NoOfMonths || 'N/A'"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Special Instruction</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.Remarks || 'N/A'"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Availability in the Apartment:</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="AvailabilityList != null ? (AvailabilityList.Availability == true ? 'Yes' : 'No') : ''"></label>
                                </div>
                                <div class="col-md-4 mb-4" ng-if="AvailabilityList.Availability == false">
                                    <label for="phone" class="control-label">Key Collection:</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="AvailabilityList != null ? (AvailabilityList.KeyCollection == true ? 'Yes' : 'No') : ''"></label>
                                </div>
                                <div class="col-md-4 mb-4" ng-if="AvailabilityList.Availability == false">
                                    <label for="phone" class="control-label">Access Details</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="AvailabilityList.AccessProperty || 'N/A'"></label>
                                </div>
                                <div class="col-md-4 mb-4" ng-if="AvailabilityList.Availability == false">
                                    <label for="phone" class="control-label">Date:</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="AvailabilityList.ReceptionDate==null ? 'N/A' : AvailabilityList.ReceptionDate.replace('/Date(','').replace(')/','') | date"></label>
                                </div>
                            </div>
                            <div class="row" ng-if="GetDetails.IsCarWash != false && GetDetails.IsCarWash != null">

                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Car Wash Timing</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.CarWashTimes"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Car Type</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.CarType"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Car Service Type</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.CarServiceType"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Parking Level</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.CustomCarDetails.ParkingLevel"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Parking Number</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.CustomCarDetails.ParkingNumber"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Vehicle Brand</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.CustomCarDetails.VehicleBrand"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Vehicle Color</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.CustomCarDetails.VehicleColor"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Vehicle Number</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.CustomCarDetails.VehicleNumber"></label>
                                </div>
                            </div>
                            <div class="row" ng-if="GetDetails.OtherLocation != null">
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Tower Name:</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.OtherLocation.TowerName"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Building Number</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.OtherLocation.BuildingName"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Street Number</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.OtherLocation.StreetNumber"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Zone Number</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.OtherLocation.ZoneNumber"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Location</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="GetDetails.OtherLocation.Loacation"></label>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <label for="phone" class="control-label">Location URL</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;">
                                        <a href="{{GetDetails.OtherLocation.LocationLink}}" ng-bind="GetDetails.OtherLocation.LocationLink || 'N/A'"></a>
                                    </label>
                                </div>
                            </div>

                            <div class="row" ng-if="GetDetails.Files != null">
                                <div class="col-sm-12">

                                    <a href="{{image.Value}}" class="mr-2" ng-repeat="image in GetDetails.Files" data-toggle="lightbox" data-gallery="img-gallery" data-title="Incident Images" data-max-width="600">
                                        <img class="img-responsive" ng-src="{{image.Value}}" style="width:200px;height:200px;" />
                                    </a>
                                </div>
                            </div>


                        </div>
                        <!--end::Modal body-->

                    </div>
                </div>
            </div>

            <div class="modal fade" id="kt_modal_availability" tabindex="-1" aria-hidden="true">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-dialog-centered mw-850px">
                    <!--begin::Modal content-->
                    <div class="modal-content">
                        <!--begin::Modal header-->
                        <div class="modal-header" id="kt_modal_add_customer_header">
                            <!--begin::Modal title-->
                            <h2 class="fw-bold">Availability Details</h2>
                            <!--end::Modal title-->
                            <!--begin::Close-->
                            <div data-bs-dismiss="modal" class="btn btn-icon btn-sm btn-active-icon-primary">
                                <i class="ki-outline ki-cross fs-1"></i>
                            </div>
                            <!--end::Close-->
                        </div>
                        <!--end::Modal header-->
                        <!--begin::Modal body-->
                        <div class="modal-body py-10 px-lg-17">

                            <div class="row">
                                <div class="col-md-4 mb-4" ng-if="AvailabilityList.Availability == false">
                                    <label for="phone" class="control-label">Key Collection:</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="AvailabilityList != null ? (AvailabilityList.KeyCollection != null ? 'Yes' : 'No') : ''"></label>
                                </div>
                                <div class="col-md-4 mb-4" ng-if="AvailabilityList.Availability == false">
                                    <label for="phone" class="control-label">Access Details</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="AvailabilityList.AccessProperty || 'N/A'"></label>
                                </div>
                                <div class="col-md-4 mb-4" ng-if="AvailabilityList.Availability == false">
                                    <label for="phone" class="control-label">Date:</label><br />
                                    <label class="text-wrap text-break" style="max-width: 200px;font-weight:500;" ng-bind="getFormattedDate(AvailabilityList.ReceptionDate)"></label>
                                </div>


                            </div>


                            <!--begin::Scroll-->
                            <!--end::Input group-->


                        </div>
                        <!--end::Modal body-->

                    </div>
                </div>
            </div>


            @*Reschedule Modal*@
            <div class="modal fade" tabindex="-1" id="kt_modal_stacked_2">
                <div class="modal-dialog modal-dialog-centered modal-lg">

                    <div class="modal-content shadow-lg">
                        <div class="modal-header">
                            <h3 class="modal-title">Select Reschedule Date</h3>

                            <!--begin::Close-->
                            <div class="btn btn-icon btn-sm btn-active-light-primary ms-2" ng-click="InitReschedule()" data-bs-dismiss="modal" aria-label="Close">
                                <i class="ki-duotone ki-cross fs-1"><span class="path1"></span><span class="path2"></span></i>
                            </div>
                            <!--end::Close-->
                        </div>
                        <form name="RescheduleForm" novalidate>
                            <div class="modal-body">
                                <h5 class="card-title mb-5">Your Schedule Details:</h5>
                                <div class="row mb-5">
                                    <div class="col-md-4">
                                        <label class="form-label">Package Name:</label><br />
                                        <span ng-bind="selectedPackage.PackageName"></span>

                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">Service Date:</label><br />
                                        <span ng-bind="getFormattedDateDisplayRs(selectedPackage.ServiceDate) | date:'fullDate'"></span>

                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">Time Range:</label><br />
                                        <span ng-bind="selectedPackage.StartTime + ' '+ selectedPackage.EndTime"></span>

                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <label class="form-label Is-required">Select  Date</label>
                                        <input class="form-control" name="DateStart" placeholder="Pick a date" ng-model="txtStartDate"
                                               id="kt_specialize" ng-change="GetChangeDates()" required />
                                        <span ng-if="RescheduleForm.$submitted && RescheduleForm.DateStart.$invalid" style="color:red">field is required</span>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label Is-required">Select  Time</label>
                                        <select name="SelectTime" id="TimeDropdown" class="form-select mt-2" ng-options="time as time.Display for time in TimeDropdowns" data-control="select2" data-placeholder="Select a Time..." data-dropdown-parent="#kt_modal_stacked_2"
                                                ng-model="txtreschedulTime"
                                                ng-disabled="isTimeConfirmedR">
                                            <option value="" disabled>Select Time</option>
                                            <option ng-repeat="time in TimeDropdowns" value="{{ time }}">{{ time.Display }}</option>
                                        </select>
                                        <span ng-if="RescheduleForm.$submitted && RescheduleForm.DateStart.$invalid" style="color:red">field is required</span>
                                    </div>
                                </div>

                            </div>

                            <div class="modal-footer">
                                <!--begin::Button-->
                                <button type="reset" ng-click="InitReschedule()" data-bs-dismiss="modal" class="btn btn-light me-3">Discard</button>
                                <!--end::Button-->
                                <!--begin::Button-->
                                <button type="submit" class="btn btn-primary">
                                    <span class="indicator-label" id="reschedulegetbtn" ng-click="SaveRescheduleDate(RescheduleForm.$valid)">Update</span>
                                    <span class="indicator-progress" id="reschedulebtnloader">
                                        Please wait...
                                        <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                                    </span>
                                </button>
                                <!--end::Button-->
                            </div>
                        </form>
                    </div>

                </div>
            </div>

            <div class="modal fade" tabindex="-1" id="assignReqModal2">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-dialog-centered mw-850px">

                    <!--begin::Modal content-->
                    <div class="modal-content">
                        <form class="form" name="reAssignTeamForm" novalidate>
                            <!--begin::Modal header-->
                            <div class="modal-header" id="kt_modal_add_customer_header">
                                <!--begin::Modal title-->
                                <h2 class="fw-bold">Reassign Team</h2>
                                <!--end::Modal title-->
                                <!--begin::Close-->
                                <div data-bs-dismiss="modal" ng-click="initFormreAssign1()" class="btn btn-icon btn-sm btn-active-icon-primary">
                                    <i class="ki-outline ki-cross fs-1"></i>
                                </div>
                                <!--end::Close-->
                            </div>
                            <!--end::Modal header-->
                            <!--begin::Modal body-->
                            <div class="modal-body py-10 px-lg-17">
                                <div class="row">
                                    <div class="col-md-5">

                                        <label class="form-label">Previous Team:</label>
                                        <span ng-bind="TeamName"></span>

                                    </div>
                                </div>
                                <div class="row mb-4">
                                    <div class="col-md-8">
                                        <label class="required fs-6 fw-semibold mb-2">Change Type</label>
                                        <div class="btn-group d-flex" role="group" aria-label="Change Type">
                                            <input type="radio" class="btn-check" name="changeType" id="temporaryChange" ng-model="changeType" value="temporary" autocomplete="off" required>
                                            <label class="btn btn-outline-primary" for="temporaryChange">Temporary (One Service)</label>

                                            <input type="radio" class="btn-check" name="changeType" id="permanentChange" ng-model="changeType" value="permanent" autocomplete="off" required>
                                            <label class="btn btn-outline-primary" for="permanentChange">Permanent (All Future Services)</label>
                                        </div><br />
                                        <span ng-if="reAssignTeamForm.$submitted && reAssignTeamForm.changeType.$invalid" style="color:red">field is required</span>

                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-6">
                                        <label class="required fs-6 fw-semibold mb-2">Select Team</label>
                                        <select id="TeamreAssign1"
                                                name="ReTeam"
                                                ng-model="txtTeam"
                                                aria-label="Select a Team"
                                                data-control="select2"
                                                data-placeholder="Select a Team..."
                                                data-dropdown-parent="#assignReqModal2"
                                                class="form-select"
                                                required
                                                ng-disabled="DSRTeamDropdown.length === 0">

                                            <option value="" ng-if="DSRTeamDropdown.length === 0">No team is available</option>
                                            <option value="" ng-if="DSRTeamDropdown.length > 0">Select Team...</option>
                                            <option value="{{team.ID}}" ng-repeat="team in DSRTeamDropdown">
                                                {{team.Value}}
                                            </option>
                                        </select>

                                        <span ng-if="reAssignTeamForm.$submitted && reAssignTeamForm.ReTeam.$invalid" style="color:red">field is required</span>

                                    </div>
                                </div>


                            </div>
                            <!--end::Modal body-->
                            <!--begin::Modal footer-->
                            <div class="modal-footer flex-center">
                                <!--begin::Button-->
                                <button type="reset" ng-click="initFormreAssign1()" data-bs-dismiss="modal" class="btn btn-light me-3">Discard</button>
                                <!--end::Button-->
                                <!--begin::Button-->
                                <button type="submit" ng-click="ReAssignTeam(reAssignTeamForm.$valid)" class="btn btn-primary">
                                    <span class="indicator-label" id="btnAssignresave">Submit</span>
                                    <span class="indicator-progress" id="btnreTeamloader">
                                        Please wait...
                                        <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                                    </span>
                                </button>
                                <!--end::Button-->
                            </div>
                            <!--end::Modal footer-->
                        </form>
                    </div>
                </div>
            </div>

            <div class="modal fade" tabindex="-1" id="assignReqModal3">
                <!--begin::Modal dialog-->
                <div class="modal-dialog modal-dialog-centered mw-850px">

                    <!--begin::Modal content-->
                    <div class="modal-content">
                        <form class="form" name="reAssignTeamForm1" novalidate>
                            <!--begin::Modal header-->
                            <div class="modal-header" id="kt_modal_add_customer_header">
                                <!--begin::Modal title-->
                                <h2 class="fw-bold">Reassign Team</h2>
                                <!--end::Modal title-->
                                <!--begin::Close-->
                                <div data-bs-dismiss="modal" ng-click="initFormreAssign3()" class="btn btn-icon btn-sm btn-active-icon-primary">
                                    <i class="ki-outline ki-cross fs-1"></i>
                                </div>
                                <!--end::Close-->
                            </div>
                            <!--end::Modal header-->
                            <!--begin::Modal body-->
                            <div class="modal-body py-10 px-lg-17">
                                <div class="row">
                                    <div class="col-md-5">

                                        <label class="form-label">Previous Team:</label>
                                        <span ng-bind="TeamName"></span>

                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-6">
                                        <label class="required fs-6 fw-semibold mb-2">Select Team</label>
                                        <select id="TeamreAAssign"
                                                name="ReTeam"
                                                ng-model="txtTeam"
                                                aria-label="Select a Team"
                                                data-control="select2"
                                                data-placeholder="Select a Team..."
                                                data-dropdown-parent="#assignReqModal3"
                                                class="form-select"
                                                required
                                                ng-disabled="DSRTeamDropdown.length === 0">

                                            <option value="" ng-if="DSRTeamDropdown.length === 0">No team is available</option>
                                            <option value="" ng-if="DSRTeamDropdown.length > 0">Select Team...</option>
                                            <option value="{{team.ID}}" ng-repeat="team in DSRTeamDropdown">
                                                {{team.Value}}
                                            </option>
                                        </select>

                                        <span ng-if="reAssignTeamForm1.$submitted && reAssignTeamForm1.ReTeam.$invalid" style="color:red">field is required</span>

                                    </div>
                                </div>


                            </div>
                            <!--end::Modal body-->
                            <!--begin::Modal footer-->
                            <div class="modal-footer flex-center">
                                <!--begin::Button-->
                                <button type="reset" ng-click="initFormreAssign3()" data-bs-dismiss="modal" class="btn btn-light me-3">Discard</button>
                                <!--end::Button-->
                                <!--begin::Button-->
                                <button type="submit" ng-click="ReAssignTeam(reAssignTeamForm1.$valid)" class="btn btn-primary">
                                    <span class="indicator-label" id="btnAssignresave">Submit</span>
                                    <span class="indicator-progress" id="btnreTeamloader">
                                        Please wait...
                                        <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                                    </span>
                                </button>
                                <!--end::Button-->
                            </div>
                            <!--end::Modal footer-->
                        </form>
                    </div>
                </div>
            </div>

            @*Message Modal*@
            <div class="modal fade" id="messageModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Send Message</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form>
                                <div class="mb-3">
                                    <label for="messageType" class="form-label">Message Type</label>
                                    <select name="emailmsgType"
                                            id="emailmsg"
                                            aria-label="Select a Route"
                                            ng-model="message.isEmail"
                                            data-control="select2"
                                            data-placeholder="Select a Route..."
                                            class="form-select">
                                        <option value="">Select</option>
                                        <option value="true">Email</option>
                                        @*<option value="false">SMS</option>*@
                                    </select>
                                </div>
                                <div class="mb-3" ng-show="message.isEmail === 'true'">
                                    <label for="messageSubject" class="form-label">Subject</label>
                                    <input type="text" class="form-control" id="messageSubject" ng-model="message.subject" placeholder="Enter subject">
                                </div>
                                <div class="mb-3">
                                    <label for="messageBody" class="form-label">Message</label>
                                    <textarea class="form-control" id="messageBody" rows="5" ng-model="message.message"></textarea>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" ng-click="sendMessage()" ng-disabled="isLoading">
                                <span ng-if="!isLoading">Send</span>
                                <span ng-if="isLoading">
                                    <i class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></i>
                                    Sending...
                                </span>
                            </button>

                        </div>
                    </div>
                </div>
            </div>

        </div>


    </div>

</div>

@section scripts {

    <script src="https://cdn.jsdelivr.net/npm/alasql"></script>
    <script src="~/Scripts/Content/xlsx.core.min.js"></script>
    <script>
        new tempusDominus.TempusDominus(document.getElementById("kt_td_picker_simple"), {
            //put your config here
            display: {
                viewMode: "calendar",
                components: {
                    decades: true,
                    year: true,
                    month: true,
                    date: true,
                    hours: false,
                    minutes: false,
                    seconds: false
                }

            },
            localization: {
                format: 'dd/MM/yyyy' // Set the format here to your preferred date format
            }
        });
        new tempusDominus.TempusDominus(document.getElementById("kt_ServiceDate"), {
            //put your config here
            display: {
                viewMode: "calendar",
                components: {
                    decades: true,
                    year: true,
                    month: true,
                    date: true,
                    hours: false,
                    minutes: false,
                    seconds: false
                }
            },
            localization: {
                format: 'dd/MM/yyyy' // Set the format here to your preferred date format
            }
        });
        "use strict";
        var KTSearchHorizontal = {
            init: function () {
                var n;

                (n = document.querySelector("#kt_horizontal_search_advanced_link")).addEventListener("click", function (e) {
                    e.preventDefault(), "Advanced Search" === n.innerHTML ? (n.innerHTML = "Hide Search") : (n.innerHTML = "Advanced Search");
                });
            },
        };
        KTUtil.onDOMContentLoaded(function () {
            KTSearchHorizontal.init();
        });


    </script>




}